<script>
  const form = document.getElementById("formImovel");
  const resultadoBox = document.getElementById("resultado");

  form.onsubmit = async (e) => {
    e.preventDefault();

    resultadoBox.innerHTML = "Analisando com IA... ‚è≥";

    const prompt = `
      Avalie um im√≥vel com os seguintes dados:
      Endere√ßo: ${document.getElementById("endereco").value},
      √Årea √∫til: ${document.getElementById("area").value} m¬≤,
      Quartos: ${document.getElementById("quartos").value},
      Banheiros: ${document.getElementById("banheiros").value},
      Vagas de garagem: ${document.getElementById("vagas").value},
      Estado: ${document.getElementById("estado").value},
      Observa√ß√µes: ${document.getElementById("observacoes").value}.
      Forne√ßa uma avalia√ß√£o estimada e explique os motivos.
    `;

    try {
      const response = await fetch("/api/avaliador", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ prompt }),
      });

      const result = await response.json();

      if (result.error) {
        resultadoBox.innerHTML = "‚ùå Erro: " + result.error;
      } else {
        const texto = result.message || "Erro: resposta vazia da IA.";
        resultadoBox.innerHTML = `<strong>üìä Avalia√ß√£o da IA:</strong><br><br>${texto.replace(/\n/g, "<br>")}`;
      }
    } catch (err) {
      resultadoBox.innerHTML = "‚ùå Erro ao conectar com a IA.";
    }
  };
</script>

