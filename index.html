<!-- Tudo igual ao anterior, só muda essas partes 👇 -->
<script>
  const formImovel = document.getElementById('formImovel');
  const resultadoImovel = document.getElementById('resultadoImovel');
  const formLead = document.getElementById('formLead');
  const resultadoLead = document.getElementById('resultadoLead');

  formImovel.onsubmit = async (e) => {
    e.preventDefault();
    resultadoImovel.innerHTML = "Analisando com IA... ⏳";
    const dados = Object.fromEntries(new FormData(formImovel).entries());
    const prompt = `Você é um avaliador de imóveis. Avalie o imóvel com os seguintes dados:
    - Endereço: ${dados.endereco}
    - Área útil: ${dados.area} m²
    - Quartos: ${dados.quartos}
    - Banheiros: ${dados.banheiros}
    - Vagas de garagem: ${dados.vagas}
    - Estado do imóvel: ${dados.estado}
    - Observações: ${dados.obs || "Nenhuma"}

    Retorne:
    1. Valor estimado de mercado (em R$)
    2. Justificativa
    3. Dica de precificação para o corretor`;

    const response = await fetch("/api/avaliador.js", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ prompt })
    });
    const data = await response.json();
    resultadoImovel.innerHTML = data.choices[0].message.content;
  };

  formLead.onsubmit = async (e) => {
    e.preventDefault();
    resultadoLead.innerHTML = "Analisando lead... ⏳";
    const dados = Object.fromEntries(new FormData(formLead).entries());
    const prompt = `Você é um especialista em vendas imobiliárias. Um corretor atendeu um cliente com os seguintes dados:
    - Nome do cliente: ${dados.nome || "Não informado"}
    - Canal de atendimento: ${dados.canal}
    - Resumo do atendimento: ${dados.resumo}
    - Resultado final: ${dados.resultado}

    Analise o caso e retorne:
    📌 Motivo provável de não fechamento
    🛠️ O que poderia ter sido feito diferente
    🎯 Dica para leads semelhantes no futuro.`;

    const response = await fetch("/api/lead.js", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ prompt })
    });
    const data = await response.json();
    resultadoLead.innerHTML = data.choices[0].message.content;
  };
</script>
